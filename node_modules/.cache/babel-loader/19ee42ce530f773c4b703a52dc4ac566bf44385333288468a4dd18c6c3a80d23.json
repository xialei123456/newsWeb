{"ast":null,"code":"import { defineComponent, computed, ref, nextTick, openBlock, createElementBlock, normalizeClass, unref, createVNode, mergeProps, createSlots, renderList, withCtx, renderSlot, normalizeProps, guardReactiveProps, createElementVNode, normalizeStyle, withModifiers } from 'vue';\nimport { pick } from 'lodash-unified';\nimport '../../../hooks/index.mjs';\nimport { ElInput } from '../../input/index.mjs';\nimport { ElTooltip } from '../../tooltip/index.mjs';\nimport '../../../constants/index.mjs';\nimport '../../../utils/index.mjs';\nimport { mentionProps, mentionEmits } from './mention.mjs';\nimport { getCursorPosition, getMentionCtx } from './helper.mjs';\nimport ElMentionDropdown from './mention-dropdown2.mjs';\nimport _export_sfc from '../../../_virtual/plugin-vue_export-helper.mjs';\nimport { inputProps } from '../../input/src/input.mjs';\nimport { useNamespace } from '../../../hooks/use-namespace/index.mjs';\nimport { useId } from '../../../hooks/use-id/index.mjs';\nimport { isFunction } from '@vue/shared';\nimport { UPDATE_MODEL_EVENT } from '../../../constants/event.mjs';\nimport { useFocusController } from '../../../hooks/use-focus-controller/index.mjs';\nconst __default__ = defineComponent({\n  name: \"ElMention\"\n});\nconst _sfc_main = /* @__PURE__ */defineComponent({\n  ...__default__,\n  props: mentionProps,\n  emits: mentionEmits,\n  setup(__props, {\n    expose,\n    emit\n  }) {\n    const props = __props;\n    const passInputProps = computed(() => pick(props, Object.keys(inputProps)));\n    const ns = useNamespace(\"mention\");\n    const contentId = useId();\n    const elInputRef = ref();\n    const tooltipRef = ref();\n    const dropdownRef = ref();\n    const visible = ref(false);\n    const cursorStyle = ref();\n    const mentionCtx = ref();\n    const computedPlacement = computed(() => props.showArrow ? props.placement : `${props.placement}-start`);\n    const computedFallbackPlacements = computed(() => props.showArrow ? [\"bottom\", \"top\"] : [\"bottom-start\", \"top-start\"]);\n    const filteredOptions = computed(() => {\n      const {\n        filterOption,\n        options\n      } = props;\n      if (!mentionCtx.value || !filterOption) return options;\n      return options.filter(option => filterOption(mentionCtx.value.pattern, option));\n    });\n    const dropdownVisible = computed(() => {\n      return visible.value && (!!filteredOptions.value.length || props.loading);\n    });\n    const hoveringId = computed(() => {\n      var _a;\n      return `${contentId.value}-${(_a = dropdownRef.value) == null ? void 0 : _a.hoveringIndex}`;\n    });\n    const handleInputChange = value => {\n      emit(\"update:modelValue\", value);\n      syncAfterCursorMove();\n    };\n    const handleInputKeyDown = e => {\n      var _a, _b, _c, _d;\n      if (!(\"key\" in e)) return;\n      if ((_a = elInputRef.value) == null ? void 0 : _a.isComposing) return;\n      if ([\"ArrowLeft\", \"ArrowRight\"].includes(e.key)) {\n        syncAfterCursorMove();\n      } else if ([\"ArrowUp\", \"ArrowDown\"].includes(e.key)) {\n        if (!visible.value) return;\n        e.preventDefault();\n        const direction = e.key === \"ArrowUp\" ? \"prev\" : \"next\";\n        (_b = dropdownRef.value) == null ? void 0 : _b.navigateOptions(direction);\n      } else if ([\"Enter\"].includes(e.key)) {\n        if (!visible.value) return;\n        e.preventDefault();\n        if ((_c = dropdownRef.value) == null ? void 0 : _c.hoverOption) {\n          (_d = dropdownRef.value) == null ? void 0 : _d.selectHoverOption();\n        } else {\n          visible.value = false;\n        }\n      } else if ([\"Escape\"].includes(e.key)) {\n        if (!visible.value) return;\n        e.preventDefault();\n        visible.value = false;\n      } else if ([\"Backspace\"].includes(e.key)) {\n        if (props.whole && mentionCtx.value) {\n          const {\n            splitIndex,\n            selectionEnd,\n            pattern,\n            prefixIndex,\n            prefix\n          } = mentionCtx.value;\n          const inputEl = getInputEl();\n          if (!inputEl) return;\n          const inputValue = inputEl.value;\n          const matchOption = props.options.find(item => item.value === pattern);\n          const isWhole = isFunction(props.checkIsWhole) ? props.checkIsWhole(pattern, prefix) : matchOption;\n          if (isWhole && splitIndex !== -1 && splitIndex + 1 === selectionEnd) {\n            e.preventDefault();\n            const newValue = inputValue.slice(0, prefixIndex) + inputValue.slice(splitIndex + 1);\n            emit(UPDATE_MODEL_EVENT, newValue);\n            const newSelectionEnd = prefixIndex;\n            nextTick(() => {\n              inputEl.selectionStart = newSelectionEnd;\n              inputEl.selectionEnd = newSelectionEnd;\n              syncDropdownVisible();\n            });\n          }\n        }\n      }\n    };\n    const {\n      wrapperRef\n    } = useFocusController(elInputRef, {\n      afterFocus() {\n        syncAfterCursorMove();\n      },\n      beforeBlur(event) {\n        var _a;\n        return (_a = tooltipRef.value) == null ? void 0 : _a.isFocusInsideContent(event);\n      },\n      afterBlur() {\n        visible.value = false;\n      }\n    });\n    const handleInputMouseDown = () => {\n      syncAfterCursorMove();\n    };\n    const handleSelect = item => {\n      if (!mentionCtx.value) return;\n      const inputEl = getInputEl();\n      if (!inputEl) return;\n      const inputValue = inputEl.value;\n      const {\n        split\n      } = props;\n      const newEndPart = inputValue.slice(mentionCtx.value.end);\n      const alreadySeparated = newEndPart.startsWith(split);\n      const newMiddlePart = `${item.value}${alreadySeparated ? \"\" : split}`;\n      const newValue = inputValue.slice(0, mentionCtx.value.start) + newMiddlePart + newEndPart;\n      emit(UPDATE_MODEL_EVENT, newValue);\n      emit(\"select\", item, mentionCtx.value.prefix);\n      const newSelectionEnd = mentionCtx.value.start + newMiddlePart.length + (alreadySeparated ? 1 : 0);\n      nextTick(() => {\n        inputEl.selectionStart = newSelectionEnd;\n        inputEl.selectionEnd = newSelectionEnd;\n        inputEl.focus();\n        syncDropdownVisible();\n      });\n    };\n    const getInputEl = () => {\n      var _a, _b;\n      return props.type === \"textarea\" ? (_a = elInputRef.value) == null ? void 0 : _a.textarea : (_b = elInputRef.value) == null ? void 0 : _b.input;\n    };\n    const syncAfterCursorMove = () => {\n      setTimeout(() => {\n        syncCursor();\n        syncDropdownVisible();\n        nextTick(() => {\n          var _a;\n          return (_a = tooltipRef.value) == null ? void 0 : _a.updatePopper();\n        });\n      }, 0);\n    };\n    const syncCursor = () => {\n      const inputEl = getInputEl();\n      if (!inputEl) return;\n      const caretPosition = getCursorPosition(inputEl);\n      const inputRect = inputEl.getBoundingClientRect();\n      const elInputRect = elInputRef.value.$el.getBoundingClientRect();\n      cursorStyle.value = {\n        position: \"absolute\",\n        width: 0,\n        height: `${caretPosition.height}px`,\n        left: `${caretPosition.left + inputRect.left - elInputRect.left}px`,\n        top: `${caretPosition.top + inputRect.top - elInputRect.top}px`\n      };\n    };\n    const syncDropdownVisible = () => {\n      const inputEl = getInputEl();\n      if (document.activeElement !== inputEl) {\n        visible.value = false;\n        return;\n      }\n      const {\n        prefix,\n        split\n      } = props;\n      mentionCtx.value = getMentionCtx(inputEl, prefix, split);\n      if (mentionCtx.value && mentionCtx.value.splitIndex === -1) {\n        visible.value = true;\n        emit(\"search\", mentionCtx.value.pattern, mentionCtx.value.prefix);\n        return;\n      }\n      visible.value = false;\n    };\n    expose({\n      input: elInputRef,\n      tooltip: tooltipRef\n    });\n    return (_ctx, _cache) => {\n      return openBlock(), createElementBlock(\"div\", {\n        ref_key: \"wrapperRef\",\n        ref: wrapperRef,\n        class: normalizeClass(unref(ns).b())\n      }, [createVNode(unref(ElInput), mergeProps(mergeProps(unref(passInputProps), _ctx.$attrs), {\n        ref_key: \"elInputRef\",\n        ref: elInputRef,\n        \"model-value\": _ctx.modelValue,\n        role: unref(dropdownVisible) ? \"combobox\" : void 0,\n        \"aria-activedescendant\": unref(dropdownVisible) ? unref(hoveringId) || \"\" : void 0,\n        \"aria-controls\": unref(dropdownVisible) ? unref(contentId) : void 0,\n        \"aria-expanded\": unref(dropdownVisible) || void 0,\n        \"aria-label\": _ctx.ariaLabel,\n        \"aria-autocomplete\": unref(dropdownVisible) ? \"none\" : void 0,\n        \"aria-haspopup\": unref(dropdownVisible) ? \"listbox\" : void 0,\n        onInput: handleInputChange,\n        onKeydown: handleInputKeyDown,\n        onMousedown: handleInputMouseDown\n      }), createSlots({\n        _: 2\n      }, [renderList(_ctx.$slots, (_, name) => {\n        return {\n          name,\n          fn: withCtx(slotProps => [renderSlot(_ctx.$slots, name, normalizeProps(guardReactiveProps(slotProps)))])\n        };\n      })]), 1040, [\"model-value\", \"role\", \"aria-activedescendant\", \"aria-controls\", \"aria-expanded\", \"aria-label\", \"aria-autocomplete\", \"aria-haspopup\"]), createVNode(unref(ElTooltip), {\n        ref_key: \"tooltipRef\",\n        ref: tooltipRef,\n        visible: unref(dropdownVisible),\n        \"popper-class\": [unref(ns).e(\"popper\"), _ctx.popperClass],\n        \"popper-options\": _ctx.popperOptions,\n        placement: unref(computedPlacement),\n        \"fallback-placements\": unref(computedFallbackPlacements),\n        effect: \"light\",\n        pure: \"\",\n        offset: _ctx.offset,\n        \"show-arrow\": _ctx.showArrow\n      }, {\n        default: withCtx(() => [createElementVNode(\"div\", {\n          style: normalizeStyle(cursorStyle.value)\n        }, null, 4)]),\n        content: withCtx(() => {\n          var _a;\n          return [createVNode(ElMentionDropdown, {\n            ref_key: \"dropdownRef\",\n            ref: dropdownRef,\n            options: unref(filteredOptions),\n            disabled: _ctx.disabled,\n            loading: _ctx.loading,\n            \"content-id\": unref(contentId),\n            \"aria-label\": _ctx.ariaLabel,\n            onSelect: handleSelect,\n            onClick: withModifiers((_a = elInputRef.value) == null ? void 0 : _a.focus, [\"stop\"])\n          }, createSlots({\n            _: 2\n          }, [renderList(_ctx.$slots, (_, name) => {\n            return {\n              name,\n              fn: withCtx(slotProps => [renderSlot(_ctx.$slots, name, normalizeProps(guardReactiveProps(slotProps)))])\n            };\n          })]), 1032, [\"options\", \"disabled\", \"loading\", \"content-id\", \"aria-label\", \"onClick\"])];\n        }),\n        _: 3\n      }, 8, [\"visible\", \"popper-class\", \"popper-options\", \"placement\", \"fallback-placements\", \"offset\", \"show-arrow\"])], 2);\n    };\n  }\n});\nvar Mention = /* @__PURE__ */_export_sfc(_sfc_main, [[\"__file\", \"mention.vue\"]]);\nexport { Mention as default };","map":{"version":3,"names":["name","passInputProps","computed","pick","props","Object","keys","inputProps","ns","useNamespace","contentId","useId","elInputRef","ref","tooltipRef","dropdownRef","visible","cursorStyle","mentionCtx","computedPlacement","showArrow","placement","computedFallbackPlacements","filteredOptions","filterOption","options","value","filter","option","pattern","dropdownVisible","length","loading","hoveringId","_a","hoveringIndex","handleInputChange","emit","syncAfterCursorMove","handleInputKeyDown","e","_b","_c","_d","isComposing","includes","key","preventDefault","direction","navigateOptions","hoverOption","selectHoverOption","whole","splitIndex","selectionEnd","prefixIndex","prefix","inputEl","getInputEl","inputValue","matchOption","find","item","isWhole","isFunction","checkIsWhole","newValue","slice","UPDATE_MODEL_EVENT","newSelectionEnd","nextTick","selectionStart","syncDropdownVisible","wrapperRef","useFocusController","afterFocus","beforeBlur","event","isFocusInsideContent","afterBlur","handleInputMouseDown","handleSelect","split","newEndPart","end","alreadySeparated","startsWith","newMiddlePart","start","focus","type","textarea","input","setTimeout","syncCursor","updatePopper","caretPosition","getCursorPosition","inputRect","getBoundingClientRect","elInputRect","$el","position","width","height","left","top","document","activeElement","getMentionCtx"],"sources":["../../../../../../packages/components/mention/src/mention.vue"],"sourcesContent":["<template>\n  <div ref=\"wrapperRef\" :class=\"ns.b()\">\n    <el-input\n      v-bind=\"mergeProps(passInputProps, $attrs)\"\n      ref=\"elInputRef\"\n      :model-value=\"modelValue\"\n      :role=\"dropdownVisible ? 'combobox' : undefined\"\n      :aria-activedescendant=\"dropdownVisible ? hoveringId || '' : undefined\"\n      :aria-controls=\"dropdownVisible ? contentId : undefined\"\n      :aria-expanded=\"dropdownVisible || undefined\"\n      :aria-label=\"ariaLabel\"\n      :aria-autocomplete=\"dropdownVisible ? 'none' : undefined\"\n      :aria-haspopup=\"dropdownVisible ? 'listbox' : undefined\"\n      @input=\"handleInputChange\"\n      @keydown=\"handleInputKeyDown\"\n      @mousedown=\"handleInputMouseDown\"\n    >\n      <template v-for=\"(_, name) in $slots\" #[name]=\"slotProps\">\n        <slot :name=\"name\" v-bind=\"slotProps\" />\n      </template>\n    </el-input>\n    <el-tooltip\n      ref=\"tooltipRef\"\n      :visible=\"dropdownVisible\"\n      :popper-class=\"[ns.e('popper'), popperClass]\"\n      :popper-options=\"popperOptions\"\n      :placement=\"computedPlacement\"\n      :fallback-placements=\"computedFallbackPlacements\"\n      effect=\"light\"\n      pure\n      :offset=\"offset\"\n      :show-arrow=\"showArrow\"\n    >\n      <template #default>\n        <div :style=\"cursorStyle\" />\n      </template>\n      <template #content>\n        <el-mention-dropdown\n          ref=\"dropdownRef\"\n          :options=\"filteredOptions\"\n          :disabled=\"disabled\"\n          :loading=\"loading\"\n          :content-id=\"contentId\"\n          :aria-label=\"ariaLabel\"\n          @select=\"handleSelect\"\n          @click.stop=\"elInputRef?.focus\"\n        >\n          <template v-for=\"(_, name) in $slots\" #[name]=\"slotProps\">\n            <slot :name=\"name\" v-bind=\"slotProps\" />\n          </template>\n        </el-mention-dropdown>\n      </template>\n    </el-tooltip>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\nimport { computed, mergeProps, nextTick, ref } from 'vue'\nimport { pick } from 'lodash-unified'\nimport { useFocusController, useId, useNamespace } from '@element-plus/hooks'\nimport ElInput, { inputProps } from '@element-plus/components/input'\nimport ElTooltip from '@element-plus/components/tooltip'\nimport { UPDATE_MODEL_EVENT } from '@element-plus/constants'\nimport { isFunction } from '@element-plus/utils'\nimport { mentionEmits, mentionProps } from './mention'\nimport { getCursorPosition, getMentionCtx } from './helper'\nimport ElMentionDropdown from './mention-dropdown.vue'\n\nimport type { Placement } from '@popperjs/core'\nimport type { CSSProperties } from 'vue'\nimport type { InputInstance } from '@element-plus/components/input'\nimport type { TooltipInstance } from '@element-plus/components/tooltip'\nimport type { MentionCtx, MentionOption } from './types'\n\ndefineOptions({\n  name: 'ElMention',\n})\n\nconst props = defineProps(mentionProps)\nconst emit = defineEmits(mentionEmits)\n\nconst passInputProps = computed(() => pick(props, Object.keys(inputProps)))\n\nconst ns = useNamespace('mention')\nconst contentId = useId()\n\nconst elInputRef = ref<InputInstance>()\nconst tooltipRef = ref<TooltipInstance>()\nconst dropdownRef = ref<InstanceType<typeof ElMentionDropdown>>()\n\nconst visible = ref(false)\nconst cursorStyle = ref<CSSProperties>()\nconst mentionCtx = ref<MentionCtx>()\n\nconst computedPlacement = computed<Placement>(() =>\n  props.showArrow ? props.placement : `${props.placement}-start`\n)\n\nconst computedFallbackPlacements = computed<Placement[]>(() =>\n  props.showArrow ? ['bottom', 'top'] : ['bottom-start', 'top-start']\n)\n\nconst filteredOptions = computed(() => {\n  const { filterOption, options } = props\n  if (!mentionCtx.value || !filterOption) return options\n  return options.filter((option) =>\n    filterOption(mentionCtx.value!.pattern, option)\n  )\n})\n\nconst dropdownVisible = computed(() => {\n  return visible.value && (!!filteredOptions.value.length || props.loading)\n})\n\nconst hoveringId = computed(() => {\n  return `${contentId.value}-${dropdownRef.value?.hoveringIndex}`\n})\n\nconst handleInputChange = (value: string) => {\n  emit('update:modelValue', value)\n  syncAfterCursorMove()\n}\n\nconst handleInputKeyDown = (e: KeyboardEvent | Event) => {\n  if (!('key' in e)) return\n  if (elInputRef.value?.isComposing) return\n  if (['ArrowLeft', 'ArrowRight'].includes(e.key)) {\n    syncAfterCursorMove()\n  } else if (['ArrowUp', 'ArrowDown'].includes(e.key)) {\n    if (!visible.value) return\n    e.preventDefault()\n    const direction = e.key === 'ArrowUp' ? 'prev' : 'next'\n    dropdownRef.value?.navigateOptions(direction)\n  } else if (['Enter'].includes(e.key)) {\n    if (!visible.value) return\n    e.preventDefault()\n    if (dropdownRef.value?.hoverOption) {\n      dropdownRef.value?.selectHoverOption()\n    } else {\n      visible.value = false\n    }\n  } else if (['Escape'].includes(e.key)) {\n    if (!visible.value) return\n    e.preventDefault()\n    visible.value = false\n  } else if (['Backspace'].includes(e.key)) {\n    if (props.whole && mentionCtx.value) {\n      const { splitIndex, selectionEnd, pattern, prefixIndex, prefix } =\n        mentionCtx.value\n      const inputEl = getInputEl()\n      if (!inputEl) return\n      const inputValue = inputEl.value\n      const matchOption = props.options.find((item) => item.value === pattern)\n      const isWhole = isFunction(props.checkIsWhole)\n        ? props.checkIsWhole(pattern, prefix)\n        : matchOption\n      if (isWhole && splitIndex !== -1 && splitIndex + 1 === selectionEnd) {\n        e.preventDefault()\n        const newValue =\n          inputValue.slice(0, prefixIndex) + inputValue.slice(splitIndex + 1)\n        emit(UPDATE_MODEL_EVENT, newValue)\n\n        const newSelectionEnd = prefixIndex\n        nextTick(() => {\n          // input value is updated\n          inputEl.selectionStart = newSelectionEnd\n          inputEl.selectionEnd = newSelectionEnd\n          syncDropdownVisible()\n        })\n      }\n    }\n  }\n}\n\nconst { wrapperRef } = useFocusController(elInputRef, {\n  afterFocus() {\n    syncAfterCursorMove()\n  },\n  beforeBlur(event) {\n    return tooltipRef.value?.isFocusInsideContent(event)\n  },\n  afterBlur() {\n    visible.value = false\n  },\n})\n\nconst handleInputMouseDown = () => {\n  syncAfterCursorMove()\n}\n\nconst handleSelect = (item: MentionOption) => {\n  if (!mentionCtx.value) return\n  const inputEl = getInputEl()\n  if (!inputEl) return\n  const inputValue = inputEl.value\n  const { split } = props\n\n  const newEndPart = inputValue.slice(mentionCtx.value.end)\n  const alreadySeparated = newEndPart.startsWith(split)\n  const newMiddlePart = `${item.value}${alreadySeparated ? '' : split}`\n\n  const newValue =\n    inputValue.slice(0, mentionCtx.value.start) + newMiddlePart + newEndPart\n\n  emit(UPDATE_MODEL_EVENT, newValue)\n  emit('select', item, mentionCtx.value.prefix)\n\n  const newSelectionEnd =\n    mentionCtx.value.start + newMiddlePart.length + (alreadySeparated ? 1 : 0)\n\n  nextTick(() => {\n    // input value is updated\n    inputEl.selectionStart = newSelectionEnd\n    inputEl.selectionEnd = newSelectionEnd\n    inputEl.focus()\n    syncDropdownVisible()\n  })\n}\n\nconst getInputEl = () =>\n  props.type === 'textarea'\n    ? elInputRef.value?.textarea\n    : elInputRef.value?.input\n\nconst syncAfterCursorMove = () => {\n  // can't use nextTick(), get cursor position will be wrong\n  setTimeout(() => {\n    syncCursor()\n    syncDropdownVisible()\n    nextTick(() => tooltipRef.value?.updatePopper())\n  }, 0)\n}\n\nconst syncCursor = () => {\n  const inputEl = getInputEl()\n  if (!inputEl) return\n\n  const caretPosition = getCursorPosition(inputEl)\n  const inputRect = inputEl.getBoundingClientRect()\n  const elInputRect = elInputRef.value!.$el.getBoundingClientRect()\n\n  cursorStyle.value = {\n    position: 'absolute',\n    width: 0,\n    height: `${caretPosition.height}px`,\n    left: `${caretPosition.left + inputRect.left - elInputRect.left}px`,\n    top: `${caretPosition.top + inputRect.top - elInputRect.top}px`,\n  }\n}\n\nconst syncDropdownVisible = () => {\n  const inputEl = getInputEl()\n  if (document.activeElement !== inputEl) {\n    visible.value = false\n    return\n  }\n  const { prefix, split } = props\n  mentionCtx.value = getMentionCtx(inputEl, prefix, split)\n  if (mentionCtx.value && mentionCtx.value.splitIndex === -1) {\n    visible.value = true\n    emit('search', mentionCtx.value.pattern, mentionCtx.value.prefix)\n    return\n  }\n  visible.value = false\n}\n\ndefineExpose({\n  input: elInputRef,\n  tooltip: tooltipRef,\n})\n</script>\n"],"mappings":";;;;;;;;;;;;;;;;;mCA0Ec;EACZA,IAAM;AACR;;;;;;;;;;IAKM,MAAAC,cAAA,GAAiBC,QAAA,CAAS,MAAMC,IAAA,CAAKC,KAAA,EAAOC,MAAO,CAAAC,IAAA,CAAKC,UAAU,CAAC,CAAC;IAEpE,MAAAC,EAAA,GAAKC,YAAA,CAAa,SAAS;IACjC,MAAMC,SAAA,GAAYC,KAAM;IAExB,MAAMC,UAAA,GAAaC,GAAmB;IACtC,MAAMC,UAAA,GAAaD,GAAqB;IACxC,MAAME,WAAA,GAAcF,GAA4C;IAE1D,MAAAG,OAAA,GAAUH,GAAA,CAAI,KAAK;IACzB,MAAMI,WAAA,GAAcJ,GAAmB;IACvC,MAAMK,UAAA,GAAaL,GAAgB;IAE7B,MAAAM,iBAAA,GAAoBjB,QAAA,CAAoB,MAC5CE,KAAA,CAAMgB,SAAA,GAAYhB,KAAM,CAAAiB,SAAA,GAAY,GAAGjB,KAAA,CAAMiB,SAC/C;IAEA,MAAMC,0BAA6B,GAAApB,QAAA,CAAsB,MACvDE,KAAA,CAAMgB,SAAY,IAAC,QAAU,OAAK,CAAI,IAAC,cAAgB,aAAW,CACpE;IAEM,MAAAG,eAAA,GAAkBrB,QAAA,CAAS,MAAM;MAC/B;QAAEsB,YAAA;QAAcC;MAAY,IAAArB,KAAA;MAC9B,KAACc,UAAW,CAAAQ,KAAA,IAAS,CAACF,YAAA,EAAqB,OAAAC,OAAA;MACxC,OAAAA,OAAA,CAAQE,MAAA,CAAQC,MAAA,IACrBJ,YAAA,CAAaN,UAAW,CAAAQ,KAAA,CAAOG,OAAS,EAAAD,MAAM,CAChD;IAAA,CACD;IAEK,MAAAE,eAAA,GAAkB5B,QAAA,CAAS,MAAM;MACrC,OAAOc,OAAA,CAAQU,KAAU,MAAC,CAACH,eAAgB,CAAAG,KAAA,CAAMK,MAAA,IAAU3B,KAAM,CAAA4B,OAAA;IAAA,CAClE;IAEK,MAAAC,UAAA,GAAa/B,QAAA,CAAS,MAAM;MAChC,IAAAgC,EAAA;MACD,UAAAxB,SAAA,CAAAgB,KAAA,KAAAQ,EAAA,GAAAnB,WAAA,CAAAW,KAAA,qBAAAQ,EAAA,CAAAC,aAAA;IAED,CAAM;IACJ,MAAAC,iBAAA,GAAAV,KAA+B;MACXW,IAAA,sBAAAX,KAAA;MACtBY,mBAAA;IAEA,CAAM;IACJ,MAAIC,kBAAW,GAAAC,CAAA;MAAI,IAAAN,EAAA,EAAAO,EAAA,EAAAC,EAAA,EAAAC,EAAA;MACnB,IAAI,WAAWH,CAAO,GAAa;MACnC,IAAI,CAACN,EAAa,GAAAtB,UAAA,CAAAc,KAAA,SAAuB,QAAE,IAAMQ,EAAA,CAAAU,WAAA,EAC3B;MACtB,gBAAuB,gBAAAC,QAAsB,CAAAL,CAAA,CAAAM,GAAA,CAAE;QAC7CR,mBAAa;MAAO,oCAAAO,QAAA,CAAAL,CAAA,CAAAM,GAAA;QACpB,IAAiB,CAAA9B,OAAA,CAAAU,KAAA,EACjB;QACYc,CAAA,CAAAO,cAAA;QAAgC,MAAAC,SAClC,GAAAR,CAAS,CAASM,GAAA,cAAQ;QACpC,CAAAL,EAAA,GAAa1B,WAAA,CAAAW,KAAA,qBAAAe,EAAA,CAAAQ,eAAA,CAAAD,SAAA;MAAO,qBAAAH,QAAA,CAAAL,CAAA,CAAAM,GAAA;QACpB,IAAiB,CAAA9B,OAAA,CAAAU,KAAA,EACb;QACFc,CAAA,CAAAO,cAAA;QACF,IAAO,CAAAL,EAAA,GAAA3B,WAAA,CAAAW,KAAA,qBAAAgB,EAAA,CAAAQ,WAAA;UACL,CAAAP,EAAA,GAAA5B,WAAgB,CAAAW,KAAA,qBAAAiB,EAAA,CAAAQ,iBAAA;QAAA,CAClB;UAAAnC,OACS,CAACU,KAAA,GAAQ,KAAW;QAC7B;MAAoB,sBAAAmB,QAAA,CAAAL,CAAA,CAAAM,GAAA;QACpB,IAAiB,CAAA9B,OAAA,CAAAU,KAAA,EACjB;QAAgBc,CAAA,CAAAO,cACN;QACN/B,OAAA,CAAAU,KAAe;MACjB,YAAQ,WAAY,EAAAmB,QAAA,CAAAL,CAAA,CAAAM,GAAuB;QAE3C,IAAA1C,KAAA,CAAAgD,KAAA,IAA2BlC,UAAA,CAAAQ,KAAA;UAC3B,MAAK;YAAA2B,UAAA;YAAAC,YAAA;YAAAzB,OAAA;YAAA0B,WAAA;YAAAC;UAAA,IAAAtC,UAAA,CAAAQ,KAAA;UAAS,MAAA+B,OAAA,GAAAC,UAAA;UACd,KAAAD,OAAA,EACM;UACA,MAAAE,UAAU,GAAAF,OAAA,CAAW/B,KAAM;UAGjC,MAAekC,WAAA,GAAAxD,KAAA,CAAAqB,OAAqB,CAAAoC,IAAA,CAAAC,IAAA,IAAaA,IAAA,CAAApC,KAAoB,KAAAG,OAAA;UACnE,MAAiBkC,OAAA,GAAAC,UAAA,CAAA5D,KAAA,CAAA6D,YAAA,IAAA7D,KAAA,CAAA6D,YAAA,CAAApC,OAAA,EAAA2B,MAAA,IAAAI,WAAA;UACX,IAAAG,OAAA,IAAAV,UAAA,KACO,CAAM,KAAAA,UAAA,IAAc,KAAIC,YAAiB;YACtDd,CAAA,CAAAO,cAAA;YAEA,MAAMmB,QAAkB,GAAAP,UAAA,CAAAQ,KAAA,IAAAZ,WAAA,IAAAI,UAAA,CAAAQ,KAAA,CAAAd,UAAA;YACxBhB,IAAA,CAAA+B,kBAAe,EAAAF,QAAA;YAEb,MAAAG,eAAyB,GAAAd,WAAA;YACzBe,QAAA,OAAuB;cACHb,OAAA,CAAAc,cAAA,GAAAF,eAAA;cACrBZ,OAAA,CAAAH,YAAA,GAAAe,eAAA;cACHG,mBAAA;YAAA,CACF;UAAA;QACF;MAGF;IAAsD;IAE9B;MAAAC;IAAA,IAAAC,kBAAA,CAAA9D,UAAA;MACtB+D,WAAA;QAAArC,mBACkB;MAChB,CAAO;MACTsC,WAAAC,KAAA;QACY,IAAA3C,EAAA;QACV,QAAQA,EAAQ,GAAApB,UAAA,CAAAY,KAAA,qBAAAQ,EAAA,CAAA4C,oBAAA,CAAAD,KAAA;MAAA,CAClB;MACDE,UAAA;QAED/D,OAAA,CAAAU,KAAA;MACE;IAAoB,CACtB;IAEM,MAAAsD,oBAAwC,GAAAA,CAAA;MAC5C1C,mBAAgB;IAAO;IACvB,MAAA2C,YAAgB,GAAWnB,IAAA;MAC3B,IAAI,CAAC5C,UAAA,CAAAQ,KAAA,EAAS;MACd,MAAM+B,OAAA,GAAAC,UAAqB;MAC3B,KAAAD,OAAkB,EAElB;MACM,MAAAE,UAAA,GAAAF,OAA8B,CAAA/B,KAAA;MACpC,MAAM;QAAgBwD;MAAA,IAAA9E,KAAA;MAEhB,MAAA+E,UAAA,GAAAxB,UACa,CAAAQ,KAAA,CAAAjD,UAAA,CAAAQ,KAAoB,CAAA0D,GAAA;MAEvC,MAAAC,gBAAA,GAAyBF,UAAQ,CAAAG,UAAA,CAAAJ,KAAA;MACjC,MAAeK,aAAA,GAAiB,GAAAzB,IAAA,CAAApC,KAAA,GAAM2D,gBAAM,QAAAH,KAAA;MAE5C,MAAMhB,QAAA,GAAAP,UACO,CAAAQ,KAAA,IAAAjD,UAAA,CAAAQ,KAA4B,CAAA8D,KAAA,IAAAD,aAAA,GAAAJ,UAAA;MAEzC9C,IAAA,CAAA+B,kBAAe,EAAAF,QAAA;MAEb7B,IAAA,SAAyB,EAAAyB,IAAA,EAAA5C,UAAA,CAAAQ,KAAA,CAAA8B,MAAA;MACzB,MAAAa,eAAuB,GAAAnD,UAAA,CAAAQ,KAAA,CAAA8D,KAAA,GAAAD,aAAA,CAAAxD,MAAA,IAAAsD,gBAAA;MACvBf,QAAA,OAAc;QACMb,OAAA,CAAAc,cAAA,GAAAF,eAAA;QACrBZ,OAAA,CAAAH,YAAA,GAAAe,eAAA;QACHZ,OAAA,CAAAgC,KAAA;QAEMjB,mBAAA,EACJ;MAIF;IAEE;IACa,MAAAd,UAAA,GAAAA,CAAA;MACS,IAAAxB,EAAA,EAAAO,EAAA;MACpB,OAAArC,KAAe,CAAAsF,IAAA,eAAkB,IAAAxD,EAAA,GAAAtB,UAAc,CAAAc,KAAA,qBAAAQ,EAAA,CAAAyD,QAAA,IAAAlD,EAAA,GAAA7B,UAAA,CAAAc,KAAA,qBAAAe,EAAA,CAAAmD,KAAA;IAAA;IAEnD,MAAAtD,mBAAA,GAAAA,CAAA;MAEAuD,UAAA,OAAmB;QACjBC,UAAA;QACAtB,mBAAK;QAASF,QAAA;UAER,IAAApC,EAAA;UACA,QAAAA,EAAA,GAAApB,UAA0C,CAAAY,KAAA,qBAAAQ,EAAA,CAAA6D,YAAA;QAChD;MAEA;IAAoB;IACR,MACHD,UAAA,GAAAA,CAAA;MACP,MAAArC,OAAW,GAAcC,UAAA;MAAA,KAAAD,OAChB,EACT;MACF,MAAAuC,aAAA,GAAAC,iBAAA,CAAAxC,OAAA;MACF,MAAAyC,SAAA,GAAAzC,OAAA,CAAA0C,qBAAA;MAEA,MAAAC,WAAA,GAAAxF,UAAkC,CAAAc,KAAA,CAAA2E,GAAA,CAAAF,qBAAA;MAChClF,WAAA,CAAAS,KAA2B;QACvB4E,QAAA;QACFC,KAAA,GAAQ;QACRC,MAAA,KAAAR,aAAA,CAAAQ,MAAA;QACFC,IAAA,KAAAT,aAAA,CAAAS,IAAA,GAAAP,SAAA,CAAAO,IAAA,GAAAL,WAAA,CAAAK,IAAA;QACMC,GAAA,KAAEV,aAAkB,CAAAU,GAAA,GAAAR,SAAA,CAAAQ,GAAA,GAAAN,WAAA,CAAAM,GAAA;MAC1B;IACA;IACE,MAAAlC,mBAAgB,GAAAA,CAAA;MAChB,MAAAf,OAAA,GAAAC,UAA0B;MAC1B,IAAAiD,QAAA,CAAAC,aAAA,KAAAnD,OAAA;QACFzC,OAAA,CAAAU,KAAA;QACA;MAAgB;MAGL;QAAA8B,MAAA;QAAA0B;MAAA,IAAA9E,KAAA;MACXc,UAAO,CAAAQ,KAAA,GAAAmF,aAAA,CAAApD,OAAA,EAAAD,MAAA,EAAA0B,KAAA;MACP,IAAShE,UAAA,CAAAQ,KAAA,IAAAR,UAAA,CAAAQ,KAAA,CAAA2B,UAAA;QACVrC,OAAA,CAAAU,KAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}