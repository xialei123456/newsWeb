{"ast":null,"code":"import { ref, reactive, onMounted, computed } from 'vue';\nimport { useStore } from 'vuex';\n//import { useRouter } from 'vue-router';\nimport { setCookie, getCookie } from '@/utils/support';\nexport default {\n  __name: 'SideBar',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const showDialog = ref(false); // 控制弹出框显示/隐藏的变量\n    const loginFormRef = ref(null); // 绑定表单引用\n\n    const store = useStore(); //使用Vuex实例\n    //const router = useRouter(); \n\n    const loginForm = reactive({\n      // 格式化登录信息\n      username: '',\n      password: ''\n    });\n\n    /*--------------------登录逻辑部分-----------------*/\n    const loginRules = reactive({\n      username: [{\n        required: true,\n        message: '请输入用户名',\n        trigger: 'blur'\n      }],\n      password: [{\n        required: true,\n        message: '请输入密码',\n        trigger: 'blur',\n        min: 3\n      }]\n    });\n\n    //检查登录状态,保存到isLoggedIn里\n    // 计算属性，基于 Vuex 的 token 状态\n    const isLoggedIn = computed(() => !!store.getters.token);\n    //为什么不用ref? 因为ref 定义的值通常用于存储简单的数据，直接在模板中使用时会自动刷新 UI，但它不会自动响应其他状态的变化，除非手动更新。\n    const valid = ref(false);\n    //登录\n    const handleLogin = () => {\n      loginFormRef.value.validate().then(success => {\n        if (success) {\n          store.dispatch('Login', loginForm).then(() => {\n            setCookie('username', loginForm.username, 15);\n            setCookie('password', loginForm.password, 15);\n            isLoggedIn.value = true;\n            showDialog.value = false;\n            //router.push({ path: '/' });\n          }).catch(() => {\n            isLoggedIn.value = false;\n            showDialog.value = true;\n          });\n        } else {\n          console.log('参数验证不合法！');\n          return false;\n        }\n      });\n    };\n    onMounted(() => {\n      loginForm.username = getCookie('username') || 'admin';\n      loginForm.password = getCookie('password') || '';\n    });\n    const __returned__ = {\n      showDialog,\n      loginFormRef,\n      store,\n      loginForm,\n      loginRules,\n      isLoggedIn,\n      valid,\n      handleLogin,\n      ref,\n      reactive,\n      onMounted,\n      computed,\n      get useStore() {\n        return useStore;\n      },\n      get setCookie() {\n        return setCookie;\n      },\n      get getCookie() {\n        return getCookie;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","reactive","onMounted","computed","useStore","setCookie","getCookie","showDialog","loginFormRef","store","loginForm","username","password","loginRules","required","message","trigger","min","isLoggedIn","getters","token","valid","handleLogin","value","validate","then","success","dispatch","catch","console","log"],"sources":["D:/ForWork/找实习/中信证券code比赛/复赛/front/news-front/src/components/SideBar.vue"],"sourcesContent":["<template>\r\n  <aside class=\"sidebar\">\r\n    <div class=\"picks\">\r\n      <p style=\"margin-left:2px\">猜你喜欢</p>\r\n      <v-btn v-if=\"!isLoggedIn\" @click=\"showDialog = true\" rounded=\"lg\" size=\"small\" block>登录</v-btn>\r\n    </div>\r\n    <!-- 登录弹出框，使用v-dialog组件实现 -->\r\n    <v-dialog v-model=\"showDialog\" persistent max-width=\"400\">\r\n      <v-card>\r\n        <!-- 标题部分 -->\r\n        <v-card-title>\r\n          <span class=\"text-h5\">登录</span>\r\n        </v-card-title>\r\n        <!-- 输入字段 -->\r\n        <v-card-text>\r\n          <!-- 这里绑定 loginFormRef -->\r\n          <v-form ref=\"loginFormRef\" v-model=\"valid\" :rules=\"loginRules\" :lazy-validation=\"true\">\r\n            <v-text-field v-model=\"loginForm.username\" label=\"用户名\" required></v-text-field>\r\n            <v-text-field v-model=\"loginForm.password\" label=\"密码\" type=\"password\" required></v-text-field>\r\n          </v-form>\r\n        </v-card-text>\r\n        <!-- 按钮区域 -->\r\n        <v-card-actions>\r\n          <v-spacer></v-spacer>\r\n          <!-- 登录按钮 -->\r\n          <v-btn color=\"blue darken-1\" text @click=\"handleLogin\">登录</v-btn>\r\n          <!-- 取消按钮 -->\r\n          <v-btn color=\"grey darken-1\" text @click=\"showDialog = false\">取消</v-btn>\r\n        </v-card-actions>\r\n      </v-card>\r\n    </v-dialog>\r\n  </aside>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive, onMounted, computed } from 'vue';\r\nimport { useStore } from 'vuex';\r\n//import { useRouter } from 'vue-router';\r\nimport { setCookie, getCookie } from '@/utils/support';\r\n\r\nconst showDialog = ref(false);  // 控制弹出框显示/隐藏的变量\r\nconst loginFormRef = ref(null); // 绑定表单引用\r\n\r\nconst store = useStore();  //使用Vuex实例\r\n//const router = useRouter(); \r\n\r\nconst loginForm = reactive({  // 格式化登录信息\r\n  username: '',\r\n  password: '',\r\n});\r\n\r\n/*--------------------登录逻辑部分-----------------*/ \r\nconst loginRules = reactive({\r\n  username: [{ required: true, message: '请输入用户名', trigger: 'blur' }],\r\n  password: [{ required: true, message: '请输入密码', trigger: 'blur', min: 3 }],\r\n});\r\n\r\n//检查登录状态,保存到isLoggedIn里\r\n// 计算属性，基于 Vuex 的 token 状态\r\nconst isLoggedIn = computed(() => !!store.getters.token);\r\n//为什么不用ref? 因为ref 定义的值通常用于存储简单的数据，直接在模板中使用时会自动刷新 UI，但它不会自动响应其他状态的变化，除非手动更新。\r\nconst valid = ref(false);\r\n//登录\r\nconst handleLogin = () => {\r\n  loginFormRef.value.validate().then(success => {\r\n    if (success) {\r\n      store.dispatch('Login', loginForm).then(() => {\r\n        setCookie('username', loginForm.username, 15);\r\n        setCookie('password', loginForm.password, 15);\r\n        isLoggedIn.value = true;\r\n        showDialog.value = false;\r\n        //router.push({ path: '/' });\r\n      }).catch(() => {\r\n        isLoggedIn.value = false;\r\n        showDialog.value = true\r\n      });\r\n    } else {\r\n      console.log('参数验证不合法！');\r\n      return false;\r\n    }\r\n  });\r\n};\r\n\r\nonMounted(() => {\r\n  loginForm.username = getCookie('username') || 'admin';\r\n  loginForm.password = getCookie('password') || '';\r\n});\r\n\r\n</script>\r\n\r\n<style scoped>\r\n.sidebar {\r\n  padding: 20px;\r\n  background-color: #ffffff;\r\n  border-left: 1px solid #ddd;\r\n  width: 20%;\r\n}\r\n\r\n.picks button {\r\n  background-color: #bfcdff;\r\n  color: #000000;\r\n  border: none;\r\n  padding: 3px 6px;\r\n  cursor: pointer;\r\n  font-size: 14px;\r\n  min-width: 0;\r\n}\r\n</style>\r\n"],"mappings":"AAmCA,SAASA,GAAG,EAAEC,QAAQ,EAAEC,SAAS,EAAEC,QAAQ,QAAQ,KAAK;AACxD,SAASC,QAAQ,QAAQ,MAAM;AAC/B;AACA,SAASC,SAAS,EAAEC,SAAS,QAAQ,iBAAiB;;;;;;;IAEtD,MAAMC,UAAU,GAAGP,GAAG,CAAC,KAAK,CAAC,CAAC,CAAE;IAChC,MAAMQ,YAAY,GAAGR,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC;;IAEhC,MAAMS,KAAK,GAAGL,QAAQ,CAAC,CAAC,CAAC,CAAE;IAC3B;;IAEA,MAAMM,SAAS,GAAGT,QAAQ,CAAC;MAAG;MAC5BU,QAAQ,EAAE,EAAE;MACZC,QAAQ,EAAE;IACZ,CAAC,CAAC;;IAEF;IACA,MAAMC,UAAU,GAAGZ,QAAQ,CAAC;MAC1BU,QAAQ,EAAE,CAAC;QAAEG,QAAQ,EAAE,IAAI;QAAEC,OAAO,EAAE,QAAQ;QAAEC,OAAO,EAAE;MAAO,CAAC,CAAC;MAClEJ,QAAQ,EAAE,CAAC;QAAEE,QAAQ,EAAE,IAAI;QAAEC,OAAO,EAAE,OAAO;QAAEC,OAAO,EAAE,MAAM;QAAEC,GAAG,EAAE;MAAE,CAAC;IAC1E,CAAC,CAAC;;IAEF;IACA;IACA,MAAMC,UAAU,GAAGf,QAAQ,CAAC,MAAM,CAAC,CAACM,KAAK,CAACU,OAAO,CAACC,KAAK,CAAC;IACxD;IACA,MAAMC,KAAK,GAAGrB,GAAG,CAAC,KAAK,CAAC;IACxB;IACA,MAAMsB,WAAW,GAAGA,CAAA,KAAM;MACxBd,YAAY,CAACe,KAAK,CAACC,QAAQ,CAAC,CAAC,CAACC,IAAI,CAACC,OAAO,IAAI;QAC5C,IAAIA,OAAO,EAAE;UACXjB,KAAK,CAACkB,QAAQ,CAAC,OAAO,EAAEjB,SAAS,CAAC,CAACe,IAAI,CAAC,MAAM;YAC5CpB,SAAS,CAAC,UAAU,EAAEK,SAAS,CAACC,QAAQ,EAAE,EAAE,CAAC;YAC7CN,SAAS,CAAC,UAAU,EAAEK,SAAS,CAACE,QAAQ,EAAE,EAAE,CAAC;YAC7CM,UAAU,CAACK,KAAK,GAAG,IAAI;YACvBhB,UAAU,CAACgB,KAAK,GAAG,KAAK;YACxB;UACF,CAAC,CAAC,CAACK,KAAK,CAAC,MAAM;YACbV,UAAU,CAACK,KAAK,GAAG,KAAK;YACxBhB,UAAU,CAACgB,KAAK,GAAG,IAAI;UACzB,CAAC,CAAC;QACJ,CAAC,MAAM;UACLM,OAAO,CAACC,GAAG,CAAC,UAAU,CAAC;UACvB,OAAO,KAAK;QACd;MACF,CAAC,CAAC;IACJ,CAAC;IAED5B,SAAS,CAAC,MAAM;MACdQ,SAAS,CAACC,QAAQ,GAAGL,SAAS,CAAC,UAAU,CAAC,IAAI,OAAO;MACrDI,SAAS,CAACE,QAAQ,GAAGN,SAAS,CAAC,UAAU,CAAC,IAAI,EAAE;IAClD,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}